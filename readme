Fortran codes for the BA-GMRES method preconditioned by the NR-SOR inner iterations
Copyright 2013-2017 Keiichi Morikuni <morikuni@cs.tsukuba.ac.jp>, February 26, 2017
URL:   http://researchmap.jp/KeiichiMorikuni/

Maintained by
 Keiichi Morikuni <morikuni@cs.tsukuba.ac.jp>
 Division of Information Engineering
 Faculty of Engineering, Information and Systems
 University of Tsukuba 
 Room 1012, Laboratory of Advanced Research B
 1-1-1 Tennodai, Tsukuba, Ibaraki 305-8573, Japan

Supported by
 The Graduate University for Advanced Studies (SOKENDAI)
 Shonan Village, Hayama, Kanagawa 240-0193 Japan

This software is currently released under the GNU General Public License
http://www.gnu.org/copyleft/gpl.html

If you use this code in research for publication, please cite the papers

Morikuni, K. and Hayami, K.,
Inner-iteration Krylov subspace methods for least squares problems,
SIAM Journal on Matrix Analysis and Applications, Volume 34, Number 1,
pages 1-22, 2013

and 

Morikuni, K. and Hayami, K.,
Convergence of inner-iteration GMRES methods for rank-deficient least squares problems,
SIAM Journal on Matrix Analysis and Applications, Volume 36, Number 1,
pages 225-250, 2015.

For the commercial use, please make a contact to
Keiichi Morikuni morikuni@cs.tsukuba.ac.jp

BA-GMRES preconditioned by NR-SOR inner iterations involves the following files:

   main.f90 	last update February 25, 2017
   solver.f90	last update February 25, 2017
   sub.f90		last update February 25, 2017
   func.f90		last update February 25, 2017
   globvar.f90	last update February 25, 2017
   plot.plt		last update February 25, 2017
   makefile		last update February 25, 2017
   readme		last update February 25, 2017

A test matrix called RANDL7 in the compressed column storage (CCS) format
is given in RANDL7 directory. The values of the NR-SOR inner iteration 
parameters can be automatically tuned at each restart or specified by you.

To compile the codes and run the program, proceed as follows:

  $ make
  $ ./main --at=1 --nin=50 --omg=1.0 --tol=1e-8 --omax=800 --rmax=0 --output_mode=0 --fi=RANDL7/

  Here,
  	--at=
  		This option enables to automatically determine the values of the number of inner 
  		iterations and the relaxation parameter. A value for this option must be provided; 
  		possible values are
  		0: turn off the automatic parameter tuning 
  		1: turn on it

  	--nin=
  		This option determines the maximum number of inner iterations, which must be a positive integer. 

  		for the setting --at=0

  		for the setting --at=1  		

  	--omg=
  		This option determines the value of the relaxation parameter for --at=0; otherwise the value provided is used as the initial value of the relaxation parameter for the automatic parameter tuning

  	--tol=
  		This option determines the threshold in terms of the relative residual norm for terminating the iterations. Typically, the value is less than one.

  	--omax=
  		This option determines the maximum number of outer iterations.

  	--rmax=
  		This option determines the restart cycle. The restart is turned off for --rmax=0.

  	--output_mode=
  		This option enables a detailed output display.

  		0: turn off the detailed output display.
  		1: turn on the detailed output display.

  	--fi=
  		This option determines the directory name in which the matrix data used is contained. 
  		The directory name must be the relative one.


Then the program outputs the approximate solution data solution.dat,
the result data info.dat, and the relative residual norm history data reshis.dat.
In addition, some specific data is output in log.csv.

Please provide feedback if you have any questions or suggestions.
morikuni@cs.tsukuba.ac.jp


References
[1] Morikuni, K. and Hayami, K.,
Inner-iteration Krylov subspace methods for least squares problems,
SIAM Journal on Matrix Analysis and Applications, Volume 34, Number 1, pages 1-22, 2013.
[2] Morikuni, K. and Hayami, K.
Convergence of inner-iteration GMRES methods for least squares problems (Revised),
NII Technical Report, National Institute of Informatics, NII-2013-004E 1-24, 2013.
http://www.nii.ac.jp/TechReports/13-004E.html